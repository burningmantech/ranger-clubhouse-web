<h1>Awards for {{this.person.callsign}}</h1>

<p>
  Any awards are items grant to a person and will appear on their Me &gt; Awards page.
</p>
<p>
  <UiButton @onClick={{this.newAward}}>Grant Award</UiButton>
</p>
<table class="table table-striped table-hover table-width-auto">
  <thead>
  <tr>
    <th>Award</th>
    <th>Granted On</th>
    <th>Notes</th>
    <th>Actions</th>
  </tr>
  </thead>
  <tbody>
  {{#each this.personAwards as |pa|}}
    <tr>
      <td>
        {{pa.award.title}}
      </td>
      <td>
        {{ymd-format pa.created_at}}
      </td>
      <td>
        {{nl2br pa.notes}}
      </td>
      <td>
        <UiButton @onClick={{fn this.editAward pa}}>{{fa-icon "edit"}} Edit</UiButton>
      </td>
    </tr>
  {{else}}
    <tr>
      <td colspan="4">
        No awards have been granted yet.
      </td>
    </tr>
  {{/each}}
  </tbody>
</table>

{{#if this.entry}}
  <ModalDialog @title="{{if this.entry.isNew "Grant" "Edit"}} Award"
               @onEscape={{this.closeAward}} as |Modal|>
    <ChForm @formId="award"
            @formFor={{this.entry}}
            @onSubmit={{this.saveAward}} as |f|>
      <Modal.body>
        <FormRow>
          <f.select @name="award_id"
                    @label="Award"
                    @options={{this.awardOptions}}
                    @includeBlank={{true}}
          />
        </FormRow>
        <FormRow>
          <f.textarea @name="notes"
                      @label="Optional notes concerning this award (not shown to person)"
                      @rows={{4}}
                      @cols={{80}} />
        </FormRow>
      </Modal.body>
      <Modal.footer @noAlign={{true}}>
        <f.submit @label={{if this.entry.isNew "Grant" "Update"}} @disabled={{this.entry.isSaving}} />
        <UiCancelButton @disabled={{this.entry.isSaving}} @onClick={{this.closeAward}} />
        {{#if this.entry.isSaving}}
          <LoadingIndicator/>
        {{/if}}
        {{#unless this.entry.isNew}}
          <div class="ms-auto">
            <UiButton @type="danger" @size="sm" @onClick={{this.deleteAward}}>{{fa-icon "trash"}} Delete</UiButton>
          </div>
        {{/unless}}
      </Modal.footer>
    </ChForm>
  </ModalDialog>
{{/if}}